<%- include('../layout', { body: ` <div class="page-header"><h2>\u{1F504} Transacciones</h2><a href="/transacciones/crear" class="btn btn-primario">+ Nueva Transacci\u00F3n</a></div>${typeof mensaje !== 'undefined' && mensaje ? '<div class="alerta alerta-exito">\u2705 ' + mensaje + '</div>' : ''}${typeof error !== 'undefined' && error ? '<div class="alerta alerta-error">\u26D4 ' + error + '</div>' : ''}<div class="filtros"><form method="GET" action="/transacciones"><select name="tipo" class="form-control"><option value="">-- Todos los tipos --</option>${tiposTransaccion.map(t => '<option value="' + t + '" ' + (filtros.tipo === t ? 'selected' : '') + '>' + t + '</option>').join('')}</select><select name="articulo_id" class="form-control"><option value="">-- Todos los art\u00EDculos --</option>${articulos.map(a => '<option value="' + a.id + '" ' + (String(filtros.articulo_id) === String(a.id) ? 'selected' : '') + '>' + a.descripcion + '</option>').join('')}</select><select name="almacen_id" class="form-control"><option value="">-- Todos los almacenes --</option>${almacenes.map(a => '<option value="' + a.id + '" ' + (String(filtros.almacen_id) === String(a.id) ? 'selected' : '') + '>' + a.descripcion + '</option>').join('')}</select><input type="date" name="fecha_desde" class="form-control" value="${filtros.fecha_desde}" placeholder="Desde"><input type="date" name="fecha_hasta" class="form-control" value="${filtros.fecha_hasta}" placeholder="Hasta"><button type="submit" class="btn btn-primario">Filtrar</button></form></div><div class="card"><div class="card-body"><table class="tabla"><thead><tr><th>ID</th><th>Tipo</th><th>Art\u00EDculo</th><th>Almac\u00E9n</th><th>Fecha</th><th>Cantidad</th><th>Monto</th><th>Acciones</th></tr></thead><tbody>${transacciones.length === 0 ? '<tr><td colspan="8"><div class="vacio"><span class="vacio-icon">\u{1F4ED}</span><p>No se encontraron transacciones.</p></div></td></tr>' : ''}${transacciones.map(t => '<tr>' + '<td>' + t.id + '</td>' + '<td><span class="badge badge-' + t.tipo.toLowerCase() + '">' + t.tipo + '</span></td>' + '<td>' + t.articulo_descripcion + '</td>' + '<td>' + t.almacen_descripcion + '</td>' + '<td>' + (t.fecha instanceof Date ? t.fecha.toISOString().split('T')[0] : String(t.fecha).split('T')[0]) + '</td>' + '<td>' + parseFloat(t.cantidad).toFixed(2) + '</td>' + '<td>$' + parseFloat(t.monto).toFixed(2) + '</td>' + '<td><div class="acciones"><a href="/transacciones/' + t.id + '" class="btn btn-sm btn-secundario">\u{1F441}\uFE0F</a><form method="POST" action="/transacciones/eliminar/' + t.id + '" class="form-eliminar" onsubmit="return confirmarEliminar(this)"><button type="submit" class="btn btn-sm btn-peligro">\u{1F5D1}\uFE0F</button></form></div></td>' + '</tr>').join('')}</tbody></table></div></div>` }) %>