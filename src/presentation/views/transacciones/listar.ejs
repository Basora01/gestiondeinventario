<%- include('../layout', { body: ` <div class="page-header">
    <h2>üîÑ Transacciones</h2>
    <a href="/transacciones/crear" class="btn btn-primario">+ Nueva Transacci√≥n</a>
    </div>

    ${typeof mensaje !== 'undefined' && mensaje ? '<div class="alerta alerta-exito">‚úÖ ' + mensaje + '</div>' : ''}
    ${typeof error !== 'undefined' && error ? '<div class="alerta alerta-error">‚õî ' + error + '</div>' : ''}

    <form method="GET" class="filtros-barra">
        <div class="filtro-grupo">
            <label>Tipo</label>
            <select name="tipo" class="form-control">
                <option value="">‚Äî Todos ‚Äî</option>
                ${tiposTransaccion.map(t => '<option value="' + t + '" ' + (filtros.tipo === t ? ' selected' : '' ) + '>' + t + '</option>' ).join('')}
            </select>
        </div>
        <div class="filtro-grupo">
            <label>Art√≠culo</label>
            <select name="articulo_id" class="form-control">
                <option value="">‚Äî Todos ‚Äî</option>
                ${articulos.map(a => '<option value="' + a.id + '" ' + (String(filtros.articulo_id) === String(a.id) ? 'selected' : '' ) + '>' + a.descripcion + '</option>' ).join('')}
            </select>
        </div>
        <div class="filtro-grupo">
            <label>Almac√©n</label>
            <select name="almacen_id" class="form-control">
                <option value="">‚Äî Todos ‚Äî</option>
                ${almacenes.map(a => '<option value="' + a.id + '" ' + (String(filtros.almacen_id) === String(a.id) ? 'selected' : '' ) + '>' + a.descripcion + '</option>' ).join('')}
            </select>
        </div>
        <div class="filtro-grupo">
            <label>Fecha desde</label>
            <input type="date" name="fecha_desde" class="form-control" value="${filtros.fecha_desde || ''}">
        </div>
        <div class="filtro-grupo">
            <label>Fecha hasta</label>
            <input type="date" name="fecha_hasta" class="form-control" value="${filtros.fecha_hasta || ''}">
        </div>
        <button type="submit" class="btn btn-secundario">üîç Filtrar</button>
        <a href="/transacciones" class="btn btn-secundario">‚úñ Limpiar</a>
    </form>

    <div class="card">
        <div class="tabla-contenedor">
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Tipo</th>
                        <th>Art√≠culo</th>
                        <th>Almac√©n</th>
                        <th>Fecha</th>
                        <th>Cantidad</th>
                        <th>Monto</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    ${transacciones.length === 0 ? '<tr><td colspan="8"><div class="vacio"><span class="vacio-icon">üì≠</span><p>No se encontraron transacciones.</p></div></td></tr>' : ''}
                    ${transacciones.map(t => { const fechaStr = t.fecha instanceof Date ? t.fecha.toISOString().split('T')[0] : String(t.fecha).split('T')[0]; return '<tr>' + '<td>' + t.id + '</td>' + '<td><span class="badge badge-' + t.tipo.toLowerCase() + '">' + t.tipo + '</span></td>' + '<td>' + t.articulo_descripcion + '</td>' + '<td>' + t.almacen_descripcion + '</td>' + '<td>' + fechaStr + '</td>' + '<td>' + parseFloat(t.cantidad).toFixed(2) + '</td>' + '<td>$' + parseFloat(t.monto).toFixed(2) + '</td>' + '<td><a href="/transacciones/' + t.id + '" class="btn btn-sm btn-secundario">üëÅÔ∏è Ver</a></td>' + '</tr>'; }).join('')}
                </tbody>
            </table>
        </div>
    </div>
    ` }) %>